<div>
    <div class=" mx-auto rounded-lg mt-8 sm:mt-6 lg:mt-4 mb-6">
        <div class="bg-white dark:bg-zinc-900 overflow-hidden shadow sm:rounded-lg p-4 sm:p-6">
            @if (session()->has('message'))
                <div class="bg-green-100 border-l-4 border-green-500 text-green-700 p-4 mb-4 rounded-md" role="alert">
                    <p class="font-medium">{{ session('message') }}</p>
                </div>
            @endif

            @if (session()->has('error'))
                <div class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-4 rounded-md" role="alert">
                    <p class="font-medium">{{ session('error') }}</p>
                </div>
            @endif

            <div class="mb-6">
                <!-- Filtros y búsqueda -->
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-4">
                    <h2 class="text-xl font-semibold text-zinc-800 dark:text-zinc-200">
                        {{ __('Sesiones Activas')}}
                    </h2>

                    <div class="flex flex-col sm:flex-row w-full sm:w-auto space-y-3 sm:space-y-0 sm:space-x-2">
                        <div class="relative w-full sm:w-auto">
                            <x-input wire:model.live="search" type="text" placeholder="Buscar por usuario o IP..."
                                class="w-full pl-10 pr-4 py-2" />
                            <div class="absolute left-3 top-2.5">
                                <svg class="h-5 w-5 text-zinc-500 dark:text-zinc-400" xmlns="http://www.w3.org/2000/svg"
                                    fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                                </svg>
                            </div>
                        </div>
                        <div class="w-full sm:w-auto">
                            <x-select id="perPage" wire:model.live="perPage" :options="[
        ['value' => '10', 'text' => '10 por página'],
        ['value' => '25', 'text' => '25 por página'],
        ['value' => '50', 'text' => '50 por página'],
        ['value' => '100', 'text' => '100 por página'],
    ]" class="w-full" />
                        </div>
                    </div>
                </div>

                <x-table sort-field="{{ $sortField }}" sort-direction="{{ $sortDirection }}" :columns="[
        ['key' => 'user', 'label' => 'Usuario', 'sortable' => true],
        ['key' => 'ip_address', 'label' => 'Dirección IP', 'sortable' => true],
        ['key' => 'browser', 'label' => 'Navegador'],
        ['key' => 'last_activity', 'label' => 'Última actividad', 'sortable' => true],
        ['key' => 'actions', 'label' => 'Acciones', 'class' => 'text-right'],
    ]" empty-message="No hay sesiones activas" class="mt-6">
                    <x-slot name="desktop">
                        @forelse($sessions as $session)
                            <tr class="hover:bg-zinc-50 dark:hover:bg-zinc-700 transition-colors">
                                <td class="px-6 py-4 text-zinc-900 dark:text-zinc-300">
                                    @if ($session->user_id)
                                        <div class="flex items-center">
                                            <div class="flex-shrink-0 mr-3">
                                                <div
                                                    class="h-8 w-8 rounded-full bg-gradient-to-r from-blue-500 to-cyan-400 flex items-center justify-center">
                                                    <span
                                                        class="text-white text-xs font-bold">{{ substr($session->name ?? 'U', 0, 1) }}</span>
                                                </div>
                                            </div>
                                            <div>
                                                <div class="font-medium">{{ $session->name ?? 'Usuario eliminado' }}</div>
                                                <div class="text-zinc-500 text-xs">{{ $session->email ?? 'Sin email' }}</div>
                                            </div>
                                        </div>
                                    @else
                                        <div class="flex items-center">
                                            <div class="flex-shrink-0 mr-3">
                                                <div
                                                    class="h-8 w-8 rounded-full bg-gradient-to-r from-gray-500 to-gray-400 flex items-center justify-center">
                                                    <span class="text-white text-xs font-bold">?</span>
                                                </div>
                                            </div>
                                            <div>
                                                <div class="font-medium">Invitado</div>
                                                <div class="text-zinc-500 text-xs">Sin autenticar</div>
                                            </div>
                                        </div>
                                    @endif
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-zinc-900 dark:text-zinc-300">
                                    <div class="font-medium">{{ $session->ip_address ?? 'Desconocida' }}</div>
                                </td>
                                <td class="px-6 py-4 text-zinc-900 dark:text-zinc-300">
                                    <div class="flex items-center">
                                        <span class="mr-2">
                                            @if ($session->browser == 'Chrome')
                                                <svg class="w-5 h-5 text-zinc-600 dark:text-zinc-400"
                                                    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                                    <path
                                                        d="M12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C17.5 22 22 17.5 22 12C22 6.5 17.5 2 12 2M12 4C14.9 4 17.5 5.5 18.9 7.8C18.6 7.9 15.7 8.9 12 8.9C8.3 8.9 5.1 7.8 4.6 7.6C6 5.4 8.7 4 12 4M4.2 9.3C4.2 9.3 8.7 11.4 13.1 11.4C16.7 11.4 20 10.1 20.3 10C20.3 10 20.6 10.7 20.7 11.5C20.7 11.5 18.5 12.5 17 12.8C14.4 13.2 13 13.7 12.1 15.6C11.3 17.5 10.8 20 10.8 20C10.8 20 8.5 19.7 7.4 18.5C5.6 16.5 5.3 13.4 5.3 12C5.3 10.8 5.6 10.1 5.6 10.1L4.2 9.3M12 7C13.6 7 15 8.3 15 10C15 11.7 13.6 13 12 13C10.4 13 9 11.7 9 10C9 8.3 10.4 7 12 7M12 20C9.1 20 6.5 18.5 5.1 16.2C6.3 16.8 9.6 17.4 11.5 15.5C12.8 14.2 13.4 12.5 13.6 11.6C14.2 11.8 15 12.1 16 12.3C16 12.3 15 16.5 15.7 17.7C16.5 19.8 18.2 20 18.2 20C16.8 20 14.5 20 12 20Z" />
                                                </svg>
                                            @elseif ($session->browser == 'Firefox')
                                                <svg class="w-5 h-5 text-zinc-600 dark:text-zinc-400"
                                                    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                                    <path
                                                        d="M9.27 7.94C9.27 7.94 9.27 7.94 9.27 7.94M6.85 6.76C6.86 6.75 6.87 6.75 6.87 6.74C6.88 6.74 6.9 6.72 6.9 6.72C7.5 6.1 8.27 5.68 9.11 5.44C9.65 5.28 10.23 5.18 10.69 5C10.72 4.97 10.21 5 10.25 5C8.92 5 7.64 5.44 6.58 6.18M12.46 5C12.28 5.5 12.13 5.8 11.93 6.1C11.78 6.32 11.61 6.5 11.41 6.71C10.88 7.26 10.23 7.68 9.54 8C9.11 8.21 8.66 8.35 8.19 8.39C7.03 8.5 6 7.8 5.33 7C5.17 7.28 5 7.55 4.89 7.83C4.74 8.26 4.66 8.72 4.65 9.19C4.61 10.66 5.76 11.95 7.22 12.12C8.71 12.3 10.05 11.39 10.52 10.04C10.5 10.37 10.5 10.7 10.47 11.02C10.34 12.41 9.8 13.76 9 14.91C8.35 15.82 7.5 16.56 6.58 17.11C5.34 17.86 4 18.29 2.61 18.3C2.24 18.31 1.88 18.27 1.5 18.21C3.43 20.27 6.16 21.22 8.92 20.83C12.77 20.31 16 17.23 16.79 13.43C17.03 12.27 17.06 11.09 16.95 9.92C16.89 9.3 16.78 8.68 16.65 8.07C17.03 8.57 17.31 9.15 17.5 9.77C17.57 10 17.62 10.23 17.65 10.47C18.43 11.31 18.5 12.47 18.16 13.5C19.65 11.2 19.76 8 18.38 5.54C18.37 5.53 18.37 5.51 18.36 5.5H17.85C17.89 5.5 18.38 5.57 18.37 5.58C17.95 6.94 17.08 8 15.85 8.72C14.92 9.3 13.94 9.04 13 8.58C12.63 8.39 12.3 8.15 11.97 7.9C11.27 7.35 10.64 6.69 10.21 5.88C10.04 5.58 9.92 5.27 9.82 4.94C10.11 4.97 10.39 5 10.69 5H12.27C12.34 5 12.4 5 12.46 5M21.82 9.19C21.36 4.77 17.59 1.5 13.09 1.5C9.21 1.5 5.91 4.06 4.78 7.66C5 7.5 5.25 7.39 5.47 7.23C5.54 7.17 5.62 7.13 5.7 7.08L5.89 6.94C5.93 6.91 5.97 6.89 6 6.86L6.25 6.72C6.32 6.68 6.38 6.65 6.45 6.62L6.54 6.58C6.73 6.5 6.93 6.43 7.14 6.4C7.5 6.29 8.03 6.25 8.63 6.32C9.22 6.38 9.82 6.57 10.31 6.88C10.43 6.95 10.55 7.03 10.66 7.12C10.74 7.19 10.82 7.26 10.9 7.33C11.07 7.5 11.21 7.67 11.35 7.85C11.66 8.25 11.91 8.76 12 9.26V9.47C12 9.96 11.72 10.37 11.33 10.65V10.69C11.25 10.77 11.15 10.84 11.06 10.9C10.86 11.03 10.62 11.13 10.36 11.18C10.03 11.24 9.76 11.26 9.46 11.23C8.87 11.17 8.31 10.97 7.79 10.69C7.27 10.4 6.8 10 6.39 9.54C6.19 9.31 6 9.07 5.83 8.83C5.91 8.84 5.97 8.86 6.04 8.89C6.34 9.04 6.69 9.1 7.03 9.1C7.38 9.1 7.76 9.05 8.09 8.93L8.37 8.82C8.5 8.77 8.62 8.7 8.73 8.63L8.95 8.5L9.17 8.36C9.22 8.32 9.27 8.29 9.32 8.25C9.47 8.15 9.61 8.04 9.73 7.92C9.84 7.79 9.93 7.65 10 7.5C10.03 7.5 10.05 7.41 10.06 7.35C10.06 7.31 10.08 7.27 10.09 7.23C10.11 7.11 10.1 6.98 10.06 6.87C10 6.7 9.88 6.57 9.74 6.5C9.61 6.37 9.46 6.29 9.31 6.23C9.12 6.15 8.93 6.13 8.74 6.13C8.5 6.15 8.29 6.18 8.06 6.28C7.88 6.34 7.73 6.45 7.57 6.55C7.41 6.66 7.27 6.78 7.13 6.92C7.08 6.97 7.03 7.03 6.98 7.08C6.94 7.12 6.9 7.17 6.86 7.22C6.78 7.31 6.72 7.4 6.65 7.5C6.5 7.7 6.4 7.91 6.32 8.13C6.28 8.23 6.25 8.33 6.22 8.44C6.2 8.53 6.18 8.6 6.17 8.69C6.13 8.89 6.13 9.09 6.17 9.28C6.21 9.57 6.29 9.85 6.42 10.1C6.61 10.49 6.87 10.84 7.17 11.15C7.76 11.75 8.53 12.13 9.32 12.34C9.71 12.45 10.1 12.5 10.5 12.5C10.87 12.5 11.25 12.47 11.62 12.37C12 12.27 12.39 12.12 12.76 11.93C13.11 11.75 13.44 11.5 13.71 11.19C14.04 10.84 14.26 10.42 14.35 9.96C14.37 9.75 14.38 9.53 14.38 9.32C14.37 8.74 14.32 8.17 14.25 7.61C14.18 7.06 14.08 6.51 13.95 5.97C13.87 5.67 13.79 5.37 13.7 5.08C16.89 5.95 19.35 8.93 19.41 12.38C19.48 16.5 16.18 20 12.08 20.04C8.18 20.07 4.86 16.95 4.5 13.12C4.5 13.1 4.5 13.08 4.5 13.06C4.43 12.76 4.4 12.45 4.39 12.15C4.38 11.94 4.39 11.73 4.41 11.53C4.37 11.53 4.33 11.53 4.28 11.5H4.25C4.21 11.47 4.17 11.47 4.13 11.47C4.03 11.5 3.94 11.5 3.84 11.5C3.32 11.61 2.86 11.92 2.54 12.34C2.5 12.16 2.5 11.97 2.5 11.78C2.5 10.88 2.71 10 3.05 9.19C3.25 8.44 3.59 7.73 4.04 7.11C4.5 7.5 4.96 7.92 5.43 8.31C5.5 8.19 5.61 8.09 5.7 8C5.15 7.57 4.63 7.11 4.13 6.63C4.29 6.36 4.47 6.11 4.66 5.86C5.21 6.33 5.75 6.81 6.3 7.28L6.32 7.26C6.27 7.21 6.23 7.17 6.18 7.13C5.62 6.69 5.08 6.23 4.53 5.77C5.22 5 6.03 4.36 6.92 3.88C7.65 3.5 8.43 3.25 9.23 3.13C9.4 3.11 9.56 3.08 9.73 3.06C9.04 3.08 8.36 3.24 7.69 3.45C7.14 3.62 6.62 3.87 6.12 4.17C6.75 3.54 7.5 3.03 8.34 2.69C9.46 2.23 10.67 2 11.9 2C16.74 2 20.77 5.63 21.5 10.33C21.56 10.79 21.6 11.25 21.6 11.72C21.6 13.97 20.84 16.05 19.53 17.67C19.84 16.17 19.28 14.57 18.05 13.63C17.79 13.43 17.5 13.26 17.19 13.12C16.94 13.01 16.69 12.92 16.42 12.86C16.75 13.16 17.04 13.5 17.26 13.87C17.79 14.68 18 15.63 17.93 16.56C17.89 17.5 17.5 18.38 16.95 19.12C18.73 17.49 19.89 15.23 20.09 12.74C20.19 11.56 20.09 10.37 19.8 9.25C20.72 12.34 20.24 15.84 18.41 18.49C17.19 20.22 15.44 21.5 13.44 22.03C11.94 22.44 10.33 22.39 8.86 21.9C7.78 21.53 6.78 20.91 5.96 20.13C7.88 21.43 10.31 21.85 12.59 21.21C15.21 20.49 17.35 18.4 18.14 15.82C18.43 14.9 18.53 13.93 18.43 12.97C18.35 12.79 18.25 12.62 18.15 12.46C18 12.23 17.78 12.03 17.55 11.86C17.32 11.69 17.06 11.54 16.78 11.43C16.5 11.32 16.21 11.23 15.91 11.18C15.61 11.13 15.3 11.12 15 11.14C14.08 11.19 13.22 11.55 12.54 12.12C11.46 12.95 10.87 14.26 10.86 15.58C10.86 16.06 10.95 16.55 11.12 17C11.28 17.46 11.53 17.89 11.84 18.26C12.46 18.96 13.35 19.4 14.27 19.49C15.19 19.57 16.15 19.31 16.92 18.75C18.19 17.83 18.88 16.29 18.75 14.76C18.72 14.27 18.63 13.79 18.47 13.33C17.77 15.89 15.34 17.75 12.71 17.51C11.26 17.37 9.93 16.65 9.05 15.59C8.67 15.12 8.39 14.57 8.22 14C8.09 13.43 8.08 12.84 8.19 12.26C8.42 11.11 9.14 10.09 10.13 9.5C10.62 9.22 11.17 9.05 11.73 9C12 8.97 12.28 8.99 12.55 9.04C12.82 9.1 13.08 9.19 13.32 9.33C13.57 9.47 13.79 9.65 13.97 9.85C14.57 10.5 14.82 11.35 14.79 12.2C14.76 12.77 14.62 13.34 14.36 13.85C14.1 14.36 13.71 14.81 13.23 15.14C12.61 15.58 11.85 15.77 11.11 15.7C10.36 15.63 9.66 15.29 9.14 14.77C8.63 14.25 8.31 13.56 8.28 12.83C8.25 12.11 8.5 11.4 8.97 10.83C9.25 10.46 9.62 10.17 10.05 9.98C9.94 10.48 9.97 10.99 10.13 11.47C10.29 11.94 10.57 12.37 10.95 12.7C11.18 12.9 11.43 13.06 11.71 13.18C11.99 13.3 12.28 13.37 12.58 13.39C12.88 13.41 13.18 13.38 13.47 13.3C13.76 13.22 14.03 13.1 14.26 12.93C14.74 12.59 15.1 12.08 15.29 11.51C15.49 10.93 15.53 10.29 15.38 9.69C15.24 9.09 14.93 8.55 14.5 8.12C14.3 7.88 14.05 7.68 13.78 7.51C13.5 7.34 13.21 7.2 12.9 7.12C12.59 7.03 12.27 6.99 11.95 6.99C11.63 6.99 11.31 7.03 11 7.12C9.66 7.47 8.54 8.34 7.84 9.47C7.5 10.03 7.28 10.65 7.21 11.3C7.14 11.94 7.19 12.6 7.38 13.22C7.76 14.47 8.63 15.54 9.76 16.19C10.89 16.84 12.23 17.04 13.49 16.77C14.76 16.5 15.89 15.77 16.65 14.76C17.41 13.75 17.76 12.48 17.63 11.22C17.56 10.59 17.37 9.98 17.06 9.42C16.41 8.26 15.27 7.4 13.95 7.03C13.67 6.94 13.38 6.88 13.09 6.84C12.8 6.8 12.5 6.79 12.21 6.8C11.62 6.83 11.03 6.95 10.5 7.17C9.95 7.39 9.45 7.71 9 8.11C8.55 8.5 8.17 8.97 7.87 9.5C7.56 10.03 7.33 10.61 7.23 11.22C7.13 11.83 7.1 12.44 7.19 13.05C7.28 13.65 7.47 14.24 7.76 14.79C8.05 15.33 8.41 15.83 8.85 16.27C9.73 17.14 10.86 17.72 12.08 17.95C13.3 18.18 14.57 18.04 15.71 17.56C16.85 17.08 17.81 16.27 18.5 15.25C19.17 14.23 19.55 13.03 19.59 11.79C19.61 11.17 19.54 10.55 19.39 9.94C20.09 10.98 20.51 12.2 20.59 13.46C20.68 14.68 20.45 15.92 19.93 17.03C19.41 18.14 18.62 19.11 17.63 19.84C17.13 20.21 16.59 20.51 16.01 20.74C15.43 20.97 14.82 21.12 14.19 21.19C13.56 21.26 12.92 21.26 12.29 21.17C11.66 21.09 11.04 20.92 10.46 20.69C9.3 20.22 8.27 19.47 7.46 18.5C6.65 17.53 6.09 16.36 5.82 15.13C5.69 14.5 5.64 13.86 5.69 13.22C5.93 17.34 9.33 20.61 13.48 20.61C17.81 20.61 21.37 17.15 21.5 12.86C21.63 10.23 20.66 7.8 18.97 6C18.94 6 18.94 6.04 18.91 6.05C19 6.13 19.09 6.23 19.17 6.31C20.84 8.11 21.89 10.57 21.82 13.19C21.71 17.52 18.24 21.03 13.92 21.17C12.21 21.23 10.56 20.76 9.14 19.92C8.08 19.29 7.16 18.45 6.45 17.46C8.63 19.33 11.66 20.1 14.5 19.5C16.24 19.13 17.81 18.19 19.02 16.89C20.37 15.43 21.13 13.54 21.16 11.57C21.17 10.77 21.04 9.98 21.02 9.19Z" />
                                                </svg>
                                            @elseif ($session->browser == 'Safari')
                                                <svg class="w-5 h-5 text-zinc-600 dark:text-zinc-400"
                                                    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                                    <path
                                                        d="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12C4,14.09 4.8,16 6.11,17.41L9.88,9.88L17.41,6.11C16,4.8 14.09,4 12,4M12,20A8,8 0 0,0 20,12C20,9.91 19.2,8 17.89,6.59L14.12,14.12L6.59,17.89C8,19.2 9.91,20 12,20M12,12L11.23,11.23L7.91,14.55L12,12M16.29,9.45L12,12L12.77,12.77L16.29,9.45Z" />
                                                </svg>
                                            @elseif ($session->browser == 'Edge')
                                                <svg class="w-5 h-5 text-zinc-600 dark:text-zinc-400"
                                                    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                                    <path
                                                        d="M2.67 8.5h4.37c0-.76 0-1.57.03-2.4-.2.13-.64.43-.96.77l-.23.24C4.77 8.25 4 9.92 4 11.79c0 2.79 1.69 5.37 4.21 6.7.87.42 1.82.71 2.79.78 1.18.07 2.35-.16 3.43-.59.16-.08.32-.15.5-.25.76-.39 1.45-.88 2.07-1.44 1.08-.94 1.84-2.07 2.29-3.28 0 0-3.55.97-5.89-2.22 0 0 1.33.75 3.68.18.98-.32 1.91-.85 2.91-1.38C20.3 10.03 22 8.32 22 8.32s-1.73 5.15-7.3 5.15c-2.95 0-3.31-1.41-3.31-1.41 1.39.65 2.7.71 3.72-.11-2.08 0-2.8-2.2-2.8-2.2H21.5c.07-.97.17-1.76.14-2.57C21.33 2.83 17.04 2 17.04 2S13.8 3.83 12.5 6.38h-1.46c-.45-.9-1.01-1.8-1.7-2.68-1.11-1.35-2.46-2.52-4.7-2.71-.45-.04-.5.02-.5.05.18.14.39.26.55.44 1.19 1.26 1.76 2.72 1.95 4.39.12.86.13 1.76.03 2.63M12.53 18c0 .57.07 1.1.18 1.64 1.43.39 3 .32 4.41-.24 1.21-.49 2.29-1.29 3.15-2.32-1.66 2.33-4.35 3.92-7.4 3.92-4.95 0-9.07-4.07-9.07-9.07 0-2.94 1.43-5.64 3.76-7.3A8.96 8.96 0 0 0 3 12c0 5.52 4.47 10 9.99 10 5.35 0 9.73-4.22 9.98-9.53.03-.79.04-1.57 0-2.35a2.88 2.88 0 0 1-.44.65C22.2 11.18 22 11.67 22 11.67s-1.19 2.44-2.88 3.66c-1.15.85-2.36 1.51-3.72 1.93-1.4.39-2.7.52-3.89.48.51-.57.77-1.31.77-2.74v-15c.57.7 1 1.5 1.29 2.35M7.04 10.5H9.5v1.8c0 .98 1.1 2.21 2.5 2.21s3.5-.6 3.5-3.71c0-.82.02-1.95.04-3.3H7.04v3Z" />
                                                </svg>
                                            @elseif ($session->browser == 'Internet Explorer')
                                                <svg class="w-5 h-5 text-zinc-600 dark:text-zinc-400"
                                                    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                                    <path
                                                        d="M13,3L14,3.06C16.8,1.79 19.23,1.64 20.5,2.92C21.5,3.93 21.58,5.67 20.92,7.72C21.61,9 22,10.45 22,12L21.95,13H9.08C9.45,15.28 11.06,17 13,17C14.31,17 15.47,16.21 16.2,15H21.5C20.75,18.57 17.21,21 13,21C9.24,21 6.07,18.97 4.75,16H5.07C4.28,15.25 3.62,14.37 3.11,13.4C2.39,11.97 2,10.37 2,8.68C2,7.27 2.2,5.89 2.56,4.57C3.76,5 5.18,5.13 6.56,4.94C7.93,4.75 9.44,4.12 10.9,2.95L13,3M13,7C14.1,7 15,7.9 15,9C15,10.1 14.1,11 13,11C11.9,11 11,10.1 11,9C11,7.9 11.9,7 13,7M3,8.68C3,12.47 5.21,15.83 8.03,17.27C7.2,16.31 6.64,15.17 6.37,14H9.45C8.61,13.35 8,12.25 8,11C8,10.8 8.08,10.58 8.13,10.39L5.55,9.42C5.37,10.37 5.28,11.3 5.28,12.23C5.28,13.03 5.4,13.87 5.61,14.72C4.71,13.59 4.12,12.22 4.12,10.86C4.12,10.21 4.24,9.55 4.5,8.92C4.09,8.9 3.69,8.83 3.31,8.7C3.24,8.83 3.18,8.96 3.13,9.08L3,8.68M20.5,5.5C19.77,4.77 18.95,5.5 18.14,5.9C16.21,6.54 14.2,6.43 13,6C13.46,6.4 13.9,6.84 14.32,7.31C14.67,6.54 15.32,6 16.15,6C17.27,6 18.17,6.88 18.17,8C18.17,9.1 17.27,10 16.15,10C15.59,10 15.08,9.76 14.72,9.4H11.03C11.34,10.37 12.28,11.12 13.56,11.19C15.56,11.31 17.39,10.33 19.14,9.19C19.34,8.26 19.03,6.7 17.84,5.5H20.5Z" />
                                                </svg>
                                            @elseif ($session->browser == 'Opera')
                                                <svg class="w-5 h-5 text-zinc-600 dark:text-zinc-400"
                                                    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                                    <path
                                                        d="M12.5,10A2.5,2.5 0 0,0 10,12.5A2.5,2.5 0 0,0 12.5,15A2.5,2.5 0 0,0 15,12.5A2.5,2.5 0 0,0 12.5,10M12.5,3C16.64,3 20,6.36 20,10.5C20,15.5 14.5,22 12.5,22C10.5,22 5,15.5 5,10.5C5,6.36 8.36,3 12.5,3M12.5,5A5.5,5.5 0 0,0 7,10.5C7,13.11 10.5,18.43 12.5,20.95C14.5,18.43 18,13.11 18,10.5A5.5,5.5 0 0,0 12.5,5Z" />
                                                </svg>
                                            @else
                                                <svg class="w-5 h-5 text-zinc-600 dark:text-zinc-400"
                                                    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                                    <path
                                                        d="M17,9H7V7H17M17,13H7V11H17M14,17H7V15H14M12,3A1,1 0 0,1 13,4A1,1 0 0,1 12,5A1,1 0 0,1 11,4A1,1 0 0,1 12,3M19,3H14.82C14.4,1.84 13.3,1 12,1C10.7,1 9.6,1.84 9.18,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3Z" />
                                                </svg>
                                            @endif
                                        </span>
                                        {{ $session->browser }}
                                        {{ $session->browser_version ? 'v' . $session->browser_version : '' }}
                                    </div>
                                    <div class="text-xs text-zinc-500 dark:text-zinc-400 mt-1">
                                        {{ $session->platform }} {{ $session->platform_version ?? '' }}
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-zinc-900 dark:text-zinc-300">
                                    <div title="{{ \Carbon\Carbon::createFromTimestamp($session->last_activity)->format('d/m/Y H:i:s') }}"
                                        class="flex items-center">
                                        <svg class="w-4 h-4 mr-1.5 text-zinc-500 dark:text-zinc-400"
                                            xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                            stroke-linejoin="round">
                                            <circle cx="12" cy="12" r="10"></circle>
                                            <polyline points="12 6 12 12 16 14"></polyline>
                                        </svg>
                                        <span>{{ $session->time_ago }}</span>
                                        @if($session->is_current_device)
                                            <span
                                                class="ml-2 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100">
                                                Dispositivo Actual
                                            </span>
                                        @endif
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                    <div class="flex justify-end space-x-2">
                                        @if(!$session->is_current_device)
                                            <button
                                                wire:click="confirmTerminate('{{ $session->id }}', {{ $session->user_id ? $session->user_id : 'null' }})"
                                                title="Terminar sesión">
                                                <svg class="w-6 h-6 text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24"
                                                    height="24" fill="none" viewBox="0 0 24 24">
                                                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                        d="M16 12H4m12 0-4 4m4-4-4-4m3-4h2a3 3 0 0 1 3 3v10a3 3 0 0 1-3 3h-2" />
                                                </svg>
                                            </button>
                                        @endif
                                        @if($session->user_id && !$session->is_current_device)
                                            <button wire:click="terminateAllUserSessions({{ $session->user_id }})"
                                                title="Terminarle todas las sesiones">
                                                <svg class="w-6 h-6 text-yellow-600 hover:text-yellow-900 dark:text-yellow-400 dark:hover:text-yellow-300" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24"
                                                    height="24" fill="none" viewBox="0 0 24 24">
                                                    <path stroke="currentColor" stroke-linecap="round" stroke-width="2"
                                                        d="m6 6 12 12m3-6a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                                                </svg>
                                            </button>
                                        @endif
                                        <button wire:click="viewSessionDetails('{{ $session->id }}')"
                                            class="text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300"
                                            title="Ver detalles">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20"
                                                fill="currentColor">
                                                <path d="M10 12a2 2 0 100-4 2 2 0 000 4z" />
                                                <path fill-rule="evenodd"
                                                    d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z"
                                                    clip-rule="evenodd" />
                                            </svg>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        @empty
                            <tr>
                                <td colspan="5" class="px-6 py-4 text-center text-zinc-500 dark:text-zinc-400">
                                    No hay sesiones activas
                                </td>
                            </tr>
                        @endforelse
                    </x-slot>

                    <x-slot name="mobile">
                        @forelse($sessions as $session)
                            <div
                                class="bg-white dark:bg-zinc-800 p-4 rounded-lg shadow-sm border border-zinc-200 dark:border-zinc-700 mb-4">
                                <div class="flex justify-between items-start mb-2">
                                    <div>
                                        <span
                                            class="bg-zinc-100 dark:bg-zinc-700 text-zinc-800 dark:text-zinc-300 px-2 py-1 rounded-full text-xs">
                                            {{ $session->ip_address ?? 'Desconocida' }}
                                        </span>
                                        @if($session->is_current_device)
                                            <span
                                                class="ml-1 inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100">
                                                Actual
                                            </span>
                                        @endif
                                    </div>
                                    <div class="flex space-x-2">
                                        @if(!$session->is_current_device)
                                            <button
                                                wire:click="confirmTerminate('{{ $session->id }}', {{ $session->user_id ? $session->user_id : 'null' }})"
                                                class="text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20"
                                                    fill="currentColor">
                                                    <path fill-rule="evenodd"
                                                        d="M3 3a1 1 0 00-1 1v12a1 1 0 102 0V4a1 1 0 00-1-1zm10.293 9.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L14.586 9H7a1 1 0 100 2h7.586l-1.293 1.293z"
                                                        clip-rule="evenodd" />
                                                </svg>
                                            </button>
                                        @endif
                                        <button wire:click="viewSessionDetails('{{ $session->id }}')"
                                            class="text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20"
                                                fill="currentColor">
                                                <path d="M10 12a2 2 0 100-4 2 2 0 000 4z" />
                                                <path fill-rule="evenodd"
                                                    d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z"
                                                    clip-rule="evenodd" />
                                            </svg>
                                        </button>
                                    </div>
                                </div>

                                @if($session->user_id)
                                    <div class="flex items-center mb-2">
                                        <div
                                            class="h-8 w-8 rounded-full bg-gradient-to-r from-blue-500 to-cyan-400 flex items-center justify-center mr-2">
                                            <span
                                                class="text-white text-xs font-bold">{{ substr($session->name ?? 'U', 0, 1) }}</span>
                                        </div>
                                        <div>
                                            <div class="font-medium text-zinc-900 dark:text-zinc-200">
                                                {{ $session->name ?? 'Usuario eliminado' }}</div>
                                            <div class="text-xs text-zinc-500 dark:text-zinc-400">
                                                {{ $session->email ?? 'Sin email' }}</div>
                                        </div>
                                    </div>
                                @else
                                    <div class="flex items-center mb-2">
                                        <div
                                            class="h-8 w-8 rounded-full bg-gradient-to-r from-gray-500 to-gray-400 flex items-center justify-center mr-2">
                                            <span class="text-white text-xs font-bold">?</span>
                                        </div>
                                        <div>
                                            <div class="font-medium text-zinc-900 dark:text-zinc-200">Invitado</div>
                                            <div class="text-xs text-zinc-500 dark:text-zinc-400">Sin autenticar</div>
                                        </div>
                                    </div>
                                @endif

                                <div class="grid grid-cols-1 gap-2 text-sm text-zinc-600 dark:text-zinc-400 mt-2">
                                    <div class="flex items-center">
                                        <span class="mr-2">
                                            @if ($session->browser == 'Chrome')
                                                <svg class="w-4 h-4 text-zinc-600 dark:text-zinc-400"
                                                    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                                    <path
                                                        d="M12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C17.5 22 22 17.5 22 12C22 6.5 17.5 2 12 2M12 4C14.9 4 17.5 5.5 18.9 7.8C18.6 7.9 15.7 8.9 12 8.9C8.3 8.9 5.1 7.8 4.6 7.6C6 5.4 8.7 4 12 4M4.2 9.3C4.2 9.3 8.7 11.4 13.1 11.4C16.7 11.4 20 10.1 20.3 10C20.3 10 20.6 10.7 20.7 11.5C20.7 11.5 18.5 12.5 17 12.8C14.4 13.2 13 13.7 12.1 15.6C11.3 17.5 10.8 20 10.8 20C10.8 20 8.5 19.7 7.4 18.5C5.6 16.5 5.3 13.4 5.3 12C5.3 10.8 5.6 10.1 5.6 10.1L4.2 9.3M12 7C13.6 7 15 8.3 15 10C15 11.7 13.6 13 12 13C10.4 13 9 11.7 9 10C9 8.3 10.4 7 12 7M12 20C9.1 20 6.5 18.5 5.1 16.2C6.3 16.8 9.6 17.4 11.5 15.5C12.8 14.2 13.4 12.5 13.6 11.6C14.2 11.8 15 12.1 16 12.3C16 12.3 15 16.5 15.7 17.7C16.5 19.8 18.2 20 18.2 20C16.8 20 14.5 20 12 20Z" />
                                                </svg>
                                            @elseif ($session->browser == 'Firefox')
                                                <svg class="w-4 h-4 text-zinc-600 dark:text-zinc-400"
                                                    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                                    <path
                                                        d="M9.27 7.94C9.27 7.94 9.27 7.94 9.27 7.94M6.85 6.76C6.86 6.75 6.87 6.75 6.87 6.74C6.88 6.74 6.9 6.72 6.9 6.72C7.5 6.1 8.27 5.68 9.11 5.44C9.65 5.28 10.23 5.18 10.69 5C10.72 4.97 10.21 5 10.25 5C8.92 5 7.64 5.44 6.58 6.18M12.46 5C12.28 5.5 12.13 5.8 11.93 6.1C11.78 6.32 11.61 6.5 11.41 6.71C10.88 7.26 10.23 7.68 9.54 8C9.11 8.21 8.66 8.35 8.19 8.39C7.03 8.5 6 7.8 5.33 7C5.17 7.28 5 7.55 4.89 7.83C4.74 8.26 4.66 8.72 4.65 9.19C4.61 10.66 5.76 11.95 7.22 12.12C8.71 12.3 10.05 11.39 10.52 10.04C10.5 10.37 10.5 10.7 10.47 11.02C10.34 12.41 9.8 13.76 9 14.91C8.35 15.82 7.5 16.56 6.58 17.11C5.34 17.86 4 18.29 2.61 18.3C2.24 18.31 1.88 18.27 1.5 18.21C3.43 20.27 6.16 21.22 8.92 20.83C12.77 20.31 16 17.23 16.79 13.43C17.03 12.27 17.06 11.09 16.95 9.92C16.89 9.3 16.78 8.68 16.65 8.07C17.03 8.57 17.31 9.15 17.5 9.77C17.57 10 17.62 10.23 17.65 10.47C18.43 11.31 18.5 12.47 18.16 13.5C19.65 11.2 19.76 8 18.38 5.54C18.37 5.53 18.37 5.51 18.36 5.5H17.85C17.89 5.5 18.38 5.57 18.37 5.58C17.95 6.94 17.08 8 15.85 8.72C14.92 9.3 13.94 9.04 13 8.58C12.63 8.39 12.3 8.15 11.97 7.9C11.27 7.35 10.64 6.69 10.21 5.88C10.04 5.58 9.92 5.27 9.82 4.94C10.11 4.97 10.39 5 10.69 5H12.27C12.34 5 12.4 5 12.46 5M21.82 9.19C21.36 4.77 17.59 1.5 13.09 1.5C9.21 1.5 5.91 4.06 4.78 7.66C5 7.5 5.25 7.39 5.47 7.23C5.54 7.17 5.62 7.13 5.7 7.08L5.89 6.94C5.93 6.91 5.97 6.89 6 6.86L6.25 6.72C6.32 6.68 6.38 6.65 6.45 6.62L6.54 6.58C6.73 6.5 6.93 6.43 7.14 6.4C7.5 6.29 8.03 6.25 8.63 6.32C9.22 6.38 9.82 6.57 10.31 6.88C10.43 6.95 10.55 7.03 10.66 7.12C10.74 7.19 10.82 7.26 10.9 7.33C11.07 7.5 11.21 7.67 11.35 7.85C11.66 8.25 11.91 8.76 12 9.26V9.47C12 9.96 11.72 10.37 11.33 10.65V10.69C11.25 10.77 11.15 10.84 11.06 10.9C10.86 11.03 10.62 11.13 10.36 11.18C10.03 11.24 9.76 11.26 9.46 11.23C8.87 11.17 8.31 10.97 7.79 10.69C7.27 10.4 6.8 10 6.39 9.54C6.19 9.31 6 9.07 5.83 8.83C5.91 8.84 5.97 8.86 6.04 8.89C6.34 9.04 6.69 9.1 7.03 9.1C7.38 9.1 7.76 9.05 8.09 8.93L8.37 8.82C8.5 8.77 8.62 8.7 8.73 8.63L8.95 8.5L9.17 8.36C9.22 8.32 9.27 8.29 9.32 8.25C9.47 8.15 9.61 8.04 9.73 7.92C9.84 7.79 9.93 7.65 10 7.5C10.03 7.5 10.05 7.41 10.06 7.35C10.06 7.31 10.08 7.27 10.09 7.23C10.11 7.11 10.1 6.98 10.06 6.87C10 6.7 9.88 6.57 9.74 6.5C9.61 6.37 9.46 6.29 9.31 6.23C9.12 6.15 8.93 6.13 8.74 6.13C8.5 6.15 8.29 6.18 8.06 6.28C7.88 6.34 7.73 6.45 7.57 6.55C7.41 6.66 7.27 6.78 7.13 6.92C7.08 6.97 7.03 7.03 6.98 7.08C6.94 7.12 6.9 7.17 6.86 7.22C6.78 7.31 6.72 7.4 6.65 7.5C6.5 7.7 6.4 7.91 6.32 8.13C6.28 8.23 6.25 8.33 6.22 8.44C6.2 8.53 6.18 8.6 6.17 8.69C6.13 8.89 6.13 9.09 6.17 9.28C6.21 9.57 6.29 9.85 6.42 10.1C6.61 10.49 6.87 10.84 7.17 11.15C7.76 11.75 8.53 12.13 9.32 12.34C9.71 12.45 10.1 12.5 10.5 12.5C10.87 12.5 11.25 12.47 11.62 12.37C12 12.27 12.39 12.12 12.76 11.93C13.11 11.75 13.44 11.5 13.71 11.19C14.04 10.84 14.26 10.42 14.35 9.96C14.37 9.75 14.38 9.53 14.38 9.32C14.37 8.74 14.32 8.17 14.25 7.61C14.18 7.06 14.08 6.51 13.95 5.97C13.87 5.67 13.79 5.37 13.7 5.08C16.89 5.95 19.35 8.93 19.41 12.38C19.48 16.5 16.18 20 12.08 20.04C8.18 20.07 4.86 16.95 4.5 13.12C4.5 13.1 4.5 13.08 4.5 13.06C4.43 12.76 4.4 12.45 4.39 12.15C4.38 11.94 4.39 11.73 4.41 11.53C4.37 11.53 4.33 11.53 4.28 11.5H4.25C4.21 11.47 4.17 11.47 4.13 11.47C4.03 11.5 3.94 11.5 3.84 11.5C3.32 11.61 2.86 11.92 2.54 12.34C2.5 12.16 2.5 11.97 2.5 11.78C2.5 10.88 2.71 10 3.05 9.19C3.25 8.44 3.59 7.73 4.04 7.11C4.5 7.5 4.96 7.92 5.43 8.31C5.5 8.19 5.61 8.09 5.7 8C5.15 7.57 4.63 7.11 4.13 6.63C4.29 6.36 4.47 6.11 4.66 5.86C5.21 6.33 5.75 6.81 6.3 7.28L6.32 7.26C6.27 7.21 6.23 7.17 6.18 7.13C5.62 6.69 5.08 6.23 4.53 5.77C5.22 5 6.03 4.36 6.92 3.88C7.65 3.5 8.43 3.25 9.23 3.13C9.4 3.11 9.56 3.08 9.73 3.06C9.04 3.08 8.36 3.24 7.69 3.45C7.14 3.62 6.62 3.87 6.12 4.17C6.75 3.54 7.5 3.03 8.34 2.69C9.46 2.23 10.67 2 11.9 2C16.74 2 20.77 5.63 21.5 10.33C21.56 10.79 21.6 11.25 21.6 11.72C21.6 13.97 20.84 16.05 19.53 17.67C19.84 16.17 19.28 14.57 18.05 13.63C17.79 13.43 17.5 13.26 17.19 13.12C16.94 13.01 16.69 12.92 16.42 12.86C16.75 13.16 17.04 13.5 17.26 13.87C17.79 14.68 18 15.63 17.93 16.56C17.89 17.5 17.5 18.38 16.95 19.12C18.73 17.49 19.89 15.23 20.09 12.74C20.19 11.56 20.09 10.37 19.8 9.25C20.72 12.34 20.24 15.84 18.41 18.49C17.19 20.22 15.44 21.5 13.44 22.03C11.94 22.44 10.33 22.39 8.86 21.9C7.78 21.53 6.78 20.91 5.96 20.13C7.88 21.43 10.31 21.85 12.59 21.21C15.21 20.49 17.35 18.4 18.14 15.82C18.43 14.9 18.53 13.93 18.43 12.97C18.35 12.79 18.25 12.62 18.15 12.46C18 12.23 17.78 12.03 17.55 11.86C17.32 11.69 17.06 11.54 16.78 11.43C16.5 11.32 16.21 11.23 15.91 11.18C15.61 11.13 15.3 11.12 15 11.14C14.08 11.19 13.22 11.55 12.54 12.12C11.46 12.95 10.87 14.26 10.86 15.58C10.86 16.06 10.95 16.55 11.12 17C11.28 17.46 11.53 17.89 11.84 18.26C12.46 18.96 13.35 19.4 14.27 19.49C15.19 19.57 16.15 19.31 16.92 18.75C18.19 17.83 18.88 16.29 18.75 14.76C18.72 14.27 18.63 13.79 18.47 13.33C17.77 15.89 15.34 17.75 12.71 17.51C11.26 17.37 9.93 16.65 9.05 15.59C8.67 15.12 8.39 14.57 8.22 14C8.09 13.43 8.08 12.84 8.19 12.26C8.42 11.11 9.14 10.09 10.13 9.5C10.62 9.22 11.17 9.05 11.73 9C12 8.97 12.28 8.99 12.55 9.04C12.82 9.1 13.08 9.19 13.32 9.33C13.57 9.47 13.79 9.65 13.97 9.85C14.57 10.5 14.82 11.35 14.79 12.2C14.76 12.77 14.62 13.34 14.36 13.85C14.1 14.36 13.71 14.81 13.23 15.14C12.61 15.58 11.85 15.77 11.11 15.7C10.36 15.63 9.66 15.29 9.14 14.77C8.63 14.25 8.31 13.56 8.28 12.83C8.25 12.11 8.5 11.4 8.97 10.83C9.25 10.46 9.62 10.17 10.05 9.98C9.94 10.48 9.97 10.99 10.13 11.47C10.29 11.94 10.57 12.37 10.95 12.7C11.18 12.9 11.43 13.06 11.71 13.18C11.99 13.3 12.28 13.37 12.58 13.39C12.88 13.41 13.18 13.38 13.47 13.3C13.76 13.22 14.03 13.1 14.26 12.93C14.74 12.59 15.1 12.08 15.29 11.51C15.49 10.93 15.53 10.29 15.38 9.69C15.24 9.09 14.93 8.55 14.5 8.12C14.3 7.88 14.05 7.68 13.78 7.51C13.5 7.34 13.21 7.2 12.9 7.12C12.59 7.03 12.27 6.99 11.95 6.99C11.63 6.99 11.31 7.03 11 7.12C9.66 7.47 8.54 8.34 7.84 9.47C7.5 10.03 7.28 10.65 7.21 11.3C7.14 11.94 7.19 12.6 7.38 13.22C7.76 14.47 8.63 15.54 9.76 16.19C10.89 16.84 12.23 17.04 13.49 16.77C14.76 16.5 15.89 15.77 16.65 14.76C17.41 13.75 17.76 12.48 17.63 11.22C17.56 10.59 17.37 9.98 17.06 9.42C16.41 8.26 15.27 7.4 13.95 7.03C13.67 6.94 13.38 6.88 13.09 6.84C12.8 6.8 12.5 6.79 12.21 6.8C11.62 6.83 11.03 6.95 10.5 7.17C9.95 7.39 9.45 7.71 9 8.11C8.55 8.5 8.17 8.97 7.87 9.5C7.56 10.03 7.33 10.61 7.23 11.22C7.13 11.83 7.1 12.44 7.19 13.05C7.28 13.65 7.47 14.24 7.76 14.79C8.05 15.33 8.41 15.83 8.85 16.27C9.73 17.14 10.86 17.72 12.08 17.95C13.3 18.18 14.57 18.04 15.71 17.56C16.85 17.08 17.81 16.27 18.5 15.25C19.17 14.23 19.55 13.03 19.59 11.79C19.61 11.17 19.54 10.55 19.39 9.94C20.09 10.98 20.51 12.2 20.59 13.46C20.68 14.68 20.45 15.92 19.93 17.03C19.41 18.14 18.62 19.11 17.63 19.84C17.13 20.21 16.59 20.51 16.01 20.74C15.43 20.97 14.82 21.12 14.19 21.19C13.56 21.26 12.92 21.26 12.29 21.17C11.66 21.09 11.04 20.92 10.46 20.69C9.3 20.22 8.27 19.47 7.46 18.5C6.65 17.53 6.09 16.36 5.82 15.13C5.69 14.5 5.64 13.86 5.69 13.22C5.93 17.34 9.33 20.61 13.48 20.61C17.81 20.61 21.37 17.15 21.5 12.86C21.63 10.23 20.66 7.8 18.97 6C18.94 6 18.94 6.04 18.91 6.05C19 6.13 19.09 6.23 19.17 6.31C20.84 8.11 21.89 10.57 21.82 13.19C21.71 17.52 18.24 21.03 13.92 21.17C12.21 21.23 10.56 20.76 9.14 19.92C8.08 19.29 7.16 18.45 6.45 17.46C8.63 19.33 11.66 20.1 14.5 19.5C16.24 19.13 17.81 18.19 19.02 16.89C20.37 15.43 21.13 13.54 21.16 11.57C21.17 10.77 21.04 9.98 21.02 9.19Z" />
                                                </svg>
                                            @else
                                                <svg class="w-4 h-4 text-zinc-600 dark:text-zinc-400"
                                                    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                                    <path
                                                        d="M17,9H7V7H17M17,13H7V11H17M14,17H7V15H14M12,3A1,1 0 0,1 13,4A1,1 0 0,1 12,5A1,1 0 0,1 11,4A1,1 0 0,1 12,3M19,3H14.82C14.4,1.84 13.3,1 12,1C10.7,1 9.6,1.84 9.18,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3Z" />
                                                </svg>
                                            @endif
                                        </span>
                                        <span>{{ $session->browser }}
                                            {{ $session->browser_version ? 'v' . $session->browser_version : '' }}</span>
                                    </div>
                                    <div class="flex items-center">
                                        <span class="font-medium mr-1">Plataforma:</span>
                                        <span>{{ $session->platform }} {{ $session->platform_version ?? '' }}</span>
                                    </div>
                                    <div class="flex items-center">
                                        <svg class="w-4 h-4 mr-1.5 text-zinc-500 dark:text-zinc-400"
                                            xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                            stroke-linejoin="round">
                                            <circle cx="12" cy="12" r="10"></circle>
                                            <polyline points="12 6 12 12 16 14"></polyline>
                                        </svg>
                                        <span
                                            title="{{ \Carbon\Carbon::createFromTimestamp($session->last_activity)->format('d/m/Y H:i:s') }}">
                                            {{ $session->time_ago }}
                                        </span>
                                    </div>
                                </div>
                            </div>
                        @empty
                            <div
                                class="bg-white dark:bg-zinc-800 p-4 rounded-lg shadow text-center text-zinc-500 dark:text-zinc-400">
                                No hay sesiones activas
                            </div>
                        @endforelse
                    </x-slot>

                    <x-slot name="footer">
                        {{ $sessions->links() }}
                    </x-slot>
                </x-table>
            </div>
        </div>
    </div>

    <!-- Modal de confirmación para terminar sesión -->
    <x-confirmation-modal maxWidth="md" wire:model="confirmingTerminate">
        <x-slot name="title">
            Terminar Sesión
        </x-slot>

        <x-slot name="content">
            @if($sessionUserName !== 'Usuario desconocido')
                ¿Está seguro de que desea terminar la sesión del usuario <span
                    class="font-semibold">{{ $sessionUserName }}</span>?
                Esta acción cerrará la sesión del usuario inmediatamente.
            @else
                ¿Está seguro de que desea terminar esta sesión?
                Esta acción cerrará la sesión inmediatamente.
            @endif
        </x-slot>

        <x-slot name="footer">
            <x-secondary-button wire:click="cancelTerminate">
                Cancelar
            </x-secondary-button>

            <x-danger-button class="ml-3" wire:click="terminateSession">
                Terminar Sesión
            </x-danger-button>
        </x-slot>
    </x-confirmation-modal>

    <!-- Modal para ver detalles de la sesión -->
    <x-dialog-modal maxWidth="md" wire:model="viewingSessionDetails">
        <x-slot name="title">
            Detalles de Sesión
        </x-slot>

        <x-slot name="content">
            @if($sessionDetails)
                <div class="space-y-4">
                    <div>
                        <h3 class="text-sm font-medium text-zinc-500 dark:text-zinc-400 mb-1">Usuario</h3>
                        <div class="flex items-center">
                            @if($sessionDetails->user_id)
                                <div class="flex-shrink-0 mr-3">
                                    <div
                                        class="h-8 w-8 rounded-full bg-gradient-to-r from-blue-500 to-cyan-400 flex items-center justify-center">
                                        <span
                                            class="text-white text-xs font-bold">{{ substr($sessionDetails->name ?? 'U', 0, 1) }}</span>
                                    </div>
                                </div>
                                <div>
                                    <div class="font-medium text-zinc-900 dark:text-zinc-200">
                                        {{ $sessionDetails->name ?? 'Usuario eliminado' }}</div>
                                    <div class="text-zinc-500 dark:text-zinc-400 text-sm">
                                        {{ $sessionDetails->email ?? 'Sin email' }}</div>
                                </div>
                            @else
                                <div class="flex-shrink-0 mr-3">
                                    <div
                                        class="h-8 w-8 rounded-full bg-gradient-to-r from-gray-500 to-gray-400 flex items-center justify-center">
                                        <span class="text-white text-xs font-bold">?</span>
                                    </div>
                                </div>
                                <div>
                                    <div class="font-medium text-zinc-900 dark:text-zinc-200">Invitado</div>
                                    <div class="text-zinc-500 dark:text-zinc-400 text-sm">Sin autenticar</div>
                                </div>
                            @endif
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <h3 class="text-sm font-medium text-zinc-500 dark:text-zinc-400 mb-1">Dirección IP</h3>
                            <p class="text-zinc-900 dark:text-zinc-200">{{ $sessionDetails->ip_address ?? 'Desconocida' }}
                            </p>
                        </div>
                        <div>
                            <h3 class="text-sm font-medium text-zinc-500 dark:text-zinc-400 mb-1">Última actividad</h3>
                            <p class="text-zinc-900 dark:text-zinc-200">
                                {{ \Carbon\Carbon::createFromTimestamp($sessionDetails->last_activity)->format('d/m/Y H:i:s') }}
                                ({{ $sessionDetails->time_ago }})
                            </p>
                        </div>
                        <div>
                            <h3 class="text-sm font-medium text-zinc-500 dark:text-zinc-400 mb-1">Navegador</h3>
                            <p class="text-zinc-900 dark:text-zinc-200">{{ $sessionDetails->browser }}
                                {{ $sessionDetails->browser_version ? 'v' . $sessionDetails->browser_version : '' }}</p>
                        </div>
                        <div>
                            <h3 class="text-sm font-medium text-zinc-500 dark:text-zinc-400 mb-1">Plataforma</h3>
                            <p class="text-zinc-900 dark:text-zinc-200">{{ $sessionDetails->platform }}
                                {{ $sessionDetails->platform_version ?? '' }}</p>
                        </div>
                        <div>
                            <h3 class="text-sm font-medium text-zinc-500 dark:text-zinc-400 mb-1">ID de Sesión</h3>
                            <p class="text-zinc-900 dark:text-zinc-200 break-all">{{ $sessionDetails->id }}</p>
                        </div>
                        <div>
                            <h3 class="text-sm font-medium text-zinc-500 dark:text-zinc-400 mb-1">Dispositivo actual</h3>
                            <p class="text-zinc-900 dark:text-zinc-200">
                                @if($sessionDetails->is_current_device)
                                    <span
                                        class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100">Sí</span>
                                @else
                                    <span
                                        class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-zinc-100 text-zinc-800 dark:bg-zinc-700 dark:text-zinc-300">No</span>
                                @endif
                            </p>
                        </div>
                    </div>

                    @if($sessionDetails->user_agent)
                        <div>
                            <h3 class="text-sm font-medium text-zinc-500 dark:text-zinc-400 mb-1">User Agent</h3>
                            <p
                                class="text-zinc-900 dark:text-zinc-200 text-sm break-all bg-zinc-50 dark:bg-zinc-800 p-2 rounded">
                                {{ $sessionDetails->user_agent }}
                            </p>
                        </div>
                    @endif
                </div>
            @else
                <div class="text-center text-zinc-500 dark:text-zinc-400">
                    No se encontraron detalles para esta sesión
                </div>
            @endif
        </x-slot>

        <x-slot name="footer">
            <div class="flex justify-end">
                <x-secondary-button wire:click="closeSessionDetailsModal">
                    Cerrar
                </x-secondary-button>

                @if($sessionDetails && !$sessionDetails->is_current_device)
                    <x-danger-button class="ml-3" wire:click="terminateSessionFromDetails">
                        Terminar Sesión
                    </x-danger-button>
                @endif
            </div>
        </x-slot>
    </x-dialog-modal>
</div>